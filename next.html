<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>HTML Generator with Bold Support</title>
  <style>
    body{font-family:Arial, sans-serif;line-height:1.4;padding:20px;background:#f6f7fb}
    h1{font-size:18px;margin-bottom:10px}
    .wrap{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    textarea{width:100%;height:300px;padding:10px;border-radius:8px;border:1px solid #ccc;resize:vertical}
    .panel{background:#fff;padding:12px;border-radius:8px;border:1px solid #ddd}
    button{margin-top:10px;padding:8px 12px;border-radius:6px;border:0;background:#2b6cff;color:#fff;cursor:pointer}
    .output{white-space:pre-wrap;background:#111;color:#eee;padding:12px;border-radius:8px;min-height:200px;overflow:auto}
    iframe{width:100%;height:250px;border:1px solid #ccc;border-radius:8px;margin-top:10px}
  </style>
</head>
<body>
  <h1>Text → HTML Body Generator</h1>
  <div class="wrap">
    <div class="panel">
      <label>Input text (use **bold** for bold, - for lists):</label>
      <textarea id="input"></textarea>

      <label>Phone number:</label>
      <input id="phone" type="text" value="0330 202 0602" style="width:100%;padding:6px" />

      <label>Booking URL:</label>
      <input id="booking" type="text" value="https://www.ukstoragecompany.co.uk/book" style="width:100%;padding:6px" />

      <button id="generate">Generate</button>
    </div>

    <div class="panel">
      <label>Generated HTML:</label>
      <div id="output" class="output"></div>
      <button id="copy">Copy</button>
      <iframe id="preview"></iframe>
    </div>
  </div>

  <script>
    function mdToBold(text){
      return text.replace(/\*\*(.+?)\*\*/g, "<b>$1</b>");
    }

    function linkifyPhone(text, phone){
      const raw = phone.replace(/\s+/g, "");
      const regex = new RegExp(phone.replace(/\s+/g,"\\s*"), "g");
      return text.replace(regex, `<a href="tel:${raw}">${phone}</a>`);
    }

    function process(input, phone, bookingUrl){
      const blocks = input.split(/\n{2,}/).map(b=>b.trim()).filter(Boolean);
      let html = [];

      blocks.forEach(block=>{
        const lines = block.split(/\n/).map(l=>l.trim()).filter(Boolean);
        const isList = lines.every(l => /^[-*]\s+/.test(l));

        if(isList){
          const items = lines.map(l=>{
            let item = l.replace(/^[-*]\s+/, "");
            item = mdToBold(item);
            item = linkifyPhone(item, phone);
            return `<li>${item}</li>`;
          }).join("");
          html.push(`<ul>${items}</ul>`);
        } else {
          let p = lines.join(" ");
          p = mdToBold(p);
          p = linkifyPhone(p, phone);
          // replace booking link placeholder
          p = p.replace(/\[Book Your Unit & Free Lock\]/g,
            `<a href="${bookingUrl}">[Book Your Unit &amp; Free Lock]</a>`);
          html.push(`<p>${p}</p>`);
        }
      });

      // Add signature if not present
      if(!/Best regards/i.test(input)){
        html.push(`<p>Best regards,<br><b>UK Storage Company</b></p>`);
      }

      return `<body>\n${html.join("\n")}\n</body>`;
    }

    const inputEl = document.getElementById("input");
    const phoneEl = document.getElementById("phone");
    const bookEl = document.getElementById("booking");
    const outEl = document.getElementById("output");
    const preview = document.getElementById("preview").contentWindow.document;

    document.getElementById("generate").addEventListener("click", ()=>{
      const html = process(inputEl.value, phoneEl.value, bookEl.value);
      outEl.textContent = html;

      preview.open();
      preview.write("<!doctype html><html><head><meta charset='utf-8'><style>body{font-family:Arial;padding:15px}</style></head>"+html+"</html>");
      preview.close();
    });

    document.getElementById("copy").addEventListener("click", ()=>{
      navigator.clipboard.writeText(outEl.textContent).then(()=>alert("Copied!"));
    });

    // Example starter text
    inputEl.value = `Still thinking about storage? We make it **easy, secure, and worry-free**.

Here’s why customers choose us:
- **Beat any previous quote by up to 10%**
- Clean, secure units ready for you
- **Free lock (£15.99)** included
- Reserve **up to 12 weeks in advance**
- Promotions **always live on our website**

Plan ahead or book now – your unit will be ready when you need it.

Call **0330 202 0602**
[Book Your Unit & Free Lock]`;
  </script>
</body>
</html>
